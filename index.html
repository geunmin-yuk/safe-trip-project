<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•ˆì‹¬ì—¬í–‰ ìŠ¤í…</title>
    
    <!-- ë””ìì¸ ë§ˆë²• (Tailwind CSS) ë¶ˆëŸ¬ì˜¤ê¸° -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ì¹´ì¹´ì˜¤ë§µ API ë¶ˆëŸ¬ì˜¤ê¸° (ê°€ì¥ ì¤‘ìš”!) -->
    <!-- YOUR_APP_KEY ë¶€ë¶„ì— ë°˜ë“œì‹œ ë³¸ì¸ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ í‚¤ë¥¼ ë„£ì–´ì£¼ì„¸ìš”! -->
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=8237f66a88d238129a48fd4a8235315c&libraries=services"></script>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto p-4 max-w-6xl">
        <!-- 1. ê²€ìƒ‰ì°½ ì˜ì—­ -->
        <div class="bg-white p-4 rounded-lg shadow-md mb-4">
            <h1 class="text-2xl font-bold text-green-600 mb-2">ì•ˆì‹¬ì—¬í–‰ ìŠ¤í… ğŸ—ºï¸</h1>
            <p class="text-gray-600 mb-4">ì–´ë””ë¡œ ë– ë‚˜ì‹œë‚˜ìš”? ì—¬í–‰ì§€ì˜ ì•ˆì „ ì ìˆ˜ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!</p>
            <div class="flex">
                <input id="search-input" type="text" placeholder="ì˜ˆ: ì„¤ì•…ì‚° ë˜ëŠ” í•´ìš´ëŒ€" class="flex-grow p-2 border rounded-l-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                <button id="search-button" class="bg-green-600 text-white font-bold p-2 rounded-r-lg hover:bg-green-700 w-20">ê²€ìƒ‰</button>
            </div>
        </div>

        <!-- 2. ì§€ë„ì™€ ì •ë³´ì°½ ì˜ì—­ -->
        <div class="flex flex-col md:flex-row gap-4">
            <!-- ì§€ë„ -->
            <div id="map" class="w-full md:w-2/3 h-96 md:h-[60vh] bg-white rounded-lg shadow-md">
                <div class="flex justify-center items-center h-full text-gray-500">
                    ì§€ë„ ë¡œë”©ì¤‘... (ì¹´ì¹´ì˜¤ë§µ í‚¤ê°€ ì •í™•í•´ì•¼ ì§€ë„ê°€ ë³´ì…ë‹ˆë‹¤!)
                </div>
            </div>

            <!-- ì •ë³´ì°½ -->
            <div id="info-window" class="w-full md:w-1/3 bg-white p-4 rounded-lg shadow-md flex flex-col">
                <h2 class="text-xl font-bold mb-4 text-center">ì•ˆì „ ì •ë³´</h2>
                <div class="text-center p-4 flex-grow flex flex-col justify-center">
                    <div id="score-circle" class="mx-auto w-32 h-32 rounded-full flex items-center justify-center text-4xl font-bold bg-gray-200 text-gray-500 transition-all duration-500">
                        ?
                    </div>
                    <p id="score-text" class="mt-2 font-semibold text-gray-600">ì¥ì†Œë¥¼ ê²€ìƒ‰í•´ì£¼ì„¸ìš”</p>
                </div>
                <div id="info-details" class="mt-4">
                    <!-- ê²€ìƒ‰ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤. -->
                </div>
            </div>
        </div>
    </div>

    <!-- 3. ìš°ë¦¬ ì›¹ì‚¬ì´íŠ¸ì˜ ë‡Œ (JavaScript) -->
    <script>
        // kakao.maps.load() í•¨ìˆ˜ëŠ” ì¹´ì¹´ì˜¤ë§µ APIê°€ ëª¨ë‘ ë¡œë“œëœ í›„, ì•ˆì˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œì¼œì¤ë‹ˆë‹¤.
        // ì´ë ‡ê²Œ í•˜ë©´ 'kakao is not defined' ì˜¤ë¥˜ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        kakao.maps.load(() => {
            // --- ì§€ë„ í‘œì‹œí•˜ê¸° ---
            const mapContainer = document.getElementById('map'); 
            const mapOption = { 
                center: new kakao.maps.LatLng(37.566826, 126.9786567), // ì²˜ìŒ ì§€ë„ì˜ ì¤‘ì‹¬: ì„œìš¸ ì‹œì²­
                level: 7 // ì²˜ìŒ ì§€ë„ í™•ëŒ€ ë ˆë²¨
            };
            const map = new kakao.maps.Map(mapContainer, mapOption); 
            
            // ì§€ë„ ìœ„ì— í‘œì‹œí•  ë§ˆì»¤ë“¤ì„ ë‹´ì„ ë°°ì—´
            let markers = [];

            // --- ìš°ë¦¬ë§Œì˜ ì‘ì€ ì•„ì´ìŠ¤ë°•ìŠ¤ (ìƒ˜í”Œ ë°ì´í„°) ---
            const sampleData = {
                "ì„¤ì•…ì‚°": {
                    lat: 38.1193,
                    lng: 128.4659,
                    score: 85,
                    facilities: [
                        { name: 'ì†ì´ˆì˜ë£Œì› (ì‘ê¸‰ì‹¤)', type: 'hospital', lat: 38.1825, lng: 128.5771 },
                        { name: 'ì„¤ì•…ì‚° íƒë°©ì§€ì›ì„¼í„° AED', type: 'aed', lat: 38.1190, lng: 128.4655 },
                        { name: 'ìƒˆì„œìš¸ì•½êµ­ (ì•¼ê°„ìš´ì˜)', type: 'pharmacy', lat: 38.2050, lng: 128.5912 }
                    ]
                },
                "í•´ìš´ëŒ€": {
                    lat: 35.1587,
                    lng: 129.1604,
                    score: 92,
                    facilities: [
                        { name: 'í•´ìš´ëŒ€ë°±ë³‘ì› (ì‘ê¸‰ì‹¤)', type: 'hospital', lat: 35.1687, lng: 129.1793 },
                        { name: 'í•´ìš´ëŒ€ í•´ìˆ˜ìš•ì¥ ê´€ê´‘ì•ˆë‚´ì†Œ AED', type: 'aed', lat: 35.1580, lng: 129.1590 },
                        { name: 'ëŒ€ìš°ì•½êµ­', type: 'pharmacy', lat: 35.1611, lng: 129.1623}
                    ]
                }
            };

            // --- ëª¨ë“  ê²ƒì„ ì—°ê²°í•˜ê³  ì›€ì§ì´ê²Œ ë§Œë“¤ê¸°! ---
            const searchInput = document.getElementById('search-input');
            const searchButton = document.getElementById('search-button');
            const scoreCircle = document.getElementById('score-circle');
            const scoreText = document.getElementById('score-text');
            const infoDetails = document.getElementById('info-details');

            // ê²€ìƒ‰ ì‹¤í–‰ í•¨ìˆ˜
            function executeSearch() {
                const query = searchInput.value;
                
                if (!query) {
                    alert("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    return;
                }

                const result = sampleData[query];
                
                if (result) {
                    // 1. ì§€ë„ë¥¼ ê²€ìƒ‰í•œ ì¥ì†Œë¡œ ì´ë™ì‹œí‚¤ê¸°
                    const moveLatLng = new kakao.maps.LatLng(result.lat, result.lng);
                    map.setCenter(moveLatLng);
                    map.setLevel(7);

                    // 2. ì ìˆ˜íŒ ì—…ë°ì´íŠ¸ í•˜ê¸°
                    scoreCircle.textContent = result.score;
                    scoreText.textContent = `${query}ì˜ ì•ˆì „ ì ìˆ˜`;
                    let scoreColorClasses = "";
                    if (result.score >= 80) {
                        scoreColorClasses = "bg-green-100 text-green-600";
                    } else if (result.score >= 50) {
                        scoreColorClasses = "bg-yellow-100 text-yellow-600";
                    } else {
                        scoreColorClasses = "bg-red-100 text-red-600";
                    }
                    scoreCircle.className = `mx-auto w-32 h-32 rounded-full flex items-center justify-center text-4xl font-bold transition-all duration-500 ${scoreColorClasses}`;
                    
                    // 3. ê¸°ì¡´ì— ìˆë˜ ë§ˆì»¤(ì•„ì´ì½˜)ë“¤ ì§€ìš°ê¸°
                    markers.forEach(marker => marker.setMap(null));
                    markers = [];

                    // 4. ì§€ë„ì— ìƒˆë¡œìš´ ì•„ì´ì½˜(ë§ˆì»¤) í‘œì‹œí•˜ê¸°
                    result.facilities.forEach(facility => {
                        const markerPosition  = new kakao.maps.LatLng(facility.lat, facility.lng); 
                        const marker = new kakao.maps.Marker({ position: markerPosition });
                        marker.setMap(map);
                        markers.push(marker); // ìƒˆë¡œ ë§Œë“  ë§ˆì»¤ë¥¼ ë°°ì—´ì— ì¶”ê°€
                    });
                    
                    // 5. ìƒì„¸ ì •ë³´ ì—…ë°ì´íŠ¸ í•˜ê¸°
                    let detailsHtml = '<h3 class="font-bold border-t pt-4 mt-4">ì£¼ìš” ì•ˆì‹¬ ì‹œì„¤</h3><ul class="list-disc pl-5 mt-2 text-gray-700 space-y-1">';
                    result.facilities.forEach(facility => {
                        let icon = facility.type === 'hospital' ? 'ğŸš‘' : (facility.type === 'aed' ? 'â¤ï¸' : 'ğŸ’Š');
                        detailsHtml += `<li>${icon} ${facility.name}</li>`;
                    });
                    detailsHtml += '</ul>';
                    infoDetails.innerHTML = detailsHtml;

                } else {
                    alert("ì£„ì†¡í•©ë‹ˆë‹¤. í•´ë‹¹ ì¥ì†Œì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.\n'ì„¤ì•…ì‚°' ë˜ëŠ” 'í•´ìš´ëŒ€'ë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”.");
                }
            }

            // ê²€ìƒ‰ ë²„íŠ¼ì„ 'í´ë¦­'í•˜ë©´ ê²€ìƒ‰ ì‹¤í–‰
            searchButton.addEventListener('click', executeSearch);

            // ì—”í„° í‚¤ë¥¼ ëˆŒëŸ¬ë„ ê²€ìƒ‰ì´ ë˜ë„ë¡ ì„¤ì •
            searchInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    executeSearch();
                }
            });
        });
    </script>
</body>
</html>

